
<!DOCTYPE html>
<html lang="pt-BR">
<head>
<meta charset="UTF-8" />
<title>MIND - Galeria de Autores</title>
<meta name="viewport" content="width=device-width, initial-scale=1.0" />

<!-- Bootstrap e ícones -->
<link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet" />
<link href="https://cdn.jsdelivr.net/npm/bootstrap-icons/font/bootstrap-icons.css" rel="stylesheet" />

<!-- Magnific Popup -->
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/magnific-popup.js/1.1.0/magnific-popup.min.css" />

<!-- Componentes -->
<script src="javascript/components/menu.js" defer></script>
<script src="javascript/components/footer.js" defer></script>
<script src="javascript/dados-autores.js" defer></script>

<style>
#page-wrapper {
  display: flex;
  flex-direction: column;
  flex: 1;
  min-height: 100vh;
  margin: auto;
  overflow: auto;
}

h2, h5 {
  text-align: center;
}

/* ===== Galeria ===== */
.gallery {
  display: grid;
  grid-template-columns: repeat(auto-fit, minmax(180px, 1fr));
  gap: 1rem;
  justify-items: center;
}

/* ===== Card ===== */
.card {
  display: flex;
  flex-direction: column;
  align-items: center;
  background: #fff;
  border-radius: 12px;
  overflow: hidden;
  box-shadow: 0 2px 8px rgba(0,0,0,0.1);
  transition: transform 0.2s ease, box-shadow 0.2s ease;
  text-align: center;
  color: inherit;
  width: 100%;
  max-width: 180px;
  text-decoration: none;
}

.card:hover {
  transform: scale(1.05);
  box-shadow: 0 8px 20px rgba(0,0,0,0.2);
}

.card img {
  width: 100%;
  height: 180px;
  object-fit: cover;
  border-radius: 8px;
  margin-bottom: 0.4rem;
  transition: transform 0.3s ease;
}

.card:hover img {
  transform: scale(1.05);
}

.legend {
  padding: 0.4rem;
  font-size: 0.85rem;
  font-weight: 500;
  width: 100%;
  display: flex;
  flex-direction: column;
  align-items: center;
  justify-content: center;
  background: #fff;
  color: #555;
  min-height: 60px;
}
 .card-participacao {
    font-size: 0.85rem;
    color: #007bff;
    margin-bottom: 0.2rem;
  }
</style>
</head>
<body>

<meu-menu></meu-menu>

<div id="page-wrapper" class="container-fluid my-4">
  <h2 class="text-danger fw-bold">Movimento para Inclusão e Neurodiversidade</h2>

  <div class="d-flex justify-content-center align-items-center flex-wrap gap-2 mt-3 mb-3">
    <h5 class="text-black m-0">Galeria de Autores com Trabalhos Publicados</h5>
    <a href="autores.html" class="btn btn-primary">
      <i class="bi bi-arrow-left-circle me-1"></i> Ver Dados Completos
    </a>
  </div>

  <!-- Filtro simples -->
  <div class="row g-2 mb-3 justify-content-center">
    <div class="col-md-3 col-sm-6">
      <select id="filtroTipo" class="form-select">
        <option value="">Filtrar por Tipo de Participação</option>
      </select>
    </div>
    <div class="col-md-2 col-sm-6">
      <button id="btnLimpar" class="btn btn-secondary w-100">Limpar</button>
    </div>
  </div>

  <!-- Galeria -->
  <div id="gallery" class="gallery"></div>
</div>

<template id="autor-card-template">
  <div class="card image">
    <img class="autor-imagem" alt="">
    <div class="legend">
      <strong class="autor-nome"></strong>
        <strong><span class="card-participacao autor-participacao"></span></strong>
    </div>
  </div>
</template>

<!-- Scripts -->
<script src="https://code.jquery.com/jquery-3.7.1.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/js/bootstrap.bundle.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/magnific-popup.js/1.1.0/jquery.magnific-popup.min.js"></script>

<script>
// ===== Web Component: autor-card =====
class AutorCard extends HTMLElement {
  connectedCallback() {
    const template = document.getElementById('autor-card-template').content.cloneNode(true);
    this.appendChild(template);

    const nome = this.getAttribute('nome');
    const tipo = this.getAttribute('tipo');
    const imagem = this.getAttribute('imagem');

    const card = this.querySelector('.card');
  //--  card.href = imagem;
    this.querySelector('.autor-imagem').src = imagem;
    this.querySelector('.autor-imagem').alt = `Foto de ${nome}`;
    this.querySelector('.autor-nome').textContent = nome;
    this.querySelector('.autor-participacao').textContent = tipo;
  }
}
customElements.define('autor-card', AutorCard);

// ===== Lógica principal =====
document.addEventListener('DOMContentLoaded', () => {
  const container = document.getElementById('gallery');
  const autores = listarItens('autores');

  // Evita repetição de nomes
  const nomesUnicos = new Map();
  autores.forEach(a => {
    if (!nomesUnicos.has(a.nome)) nomesUnicos.set(a.nome, a);
  });
  const lista = Array.from(nomesUnicos.values()).sort((a,b) => a.nome.localeCompare(b.nome));

  // Filtro de tipo
  const filtroTipo = document.getElementById('filtroTipo');
  const tipos = [...new Set(lista.map(a => a.tipoParticipacao))].sort();
  tipos.forEach(t => filtroTipo.append(new Option(t, t)));

  function renderizarGaleria(filtro='') {
    container.innerHTML = '';
    const filtrados = lista.filter(a => !filtro || a.tipoParticipacao === filtro);

    filtrados.forEach(a => {
      const item = document.createElement('autor-card');
      item.setAttribute('nome', a.nome);
      item.setAttribute('tipo', a.tipoParticipacao || '');
      item.setAttribute('imagem', `imagens/autores_equipe/${a.imagem || 'default.jpg'}`);
      container.appendChild(item);
    });
}

  renderizarGaleria();

  filtroTipo.addEventListener('change', () => renderizarGaleria(filtroTipo.value));
  document.getElementById('btnLimpar').addEventListener('click', () => {
    filtroTipo.value = '';
    renderizarGaleria();
  });
});
</script>

<meu-tradutor></meu-tradutor>
<script src="javascript/components/tradutor.js" defer></script>
<meu-footer></meu-footer>
</body>
</html>
